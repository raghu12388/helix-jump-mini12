<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Stack Ball â€“ Sound</title>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#111;
  font-family:Arial;
}
canvas{display:block}

/* UI */
#ui{
  position:fixed;
  top:10px;
  width:100%;
  text-align:center;
  color:white;
  font-size:18px;
}

/* Progress bar */
#barWrap{
  position:fixed;
  top:45px;
  left:50%;
  transform:translateX(-50%);
  width:60%;
  height:10px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
}
#bar{
  width:0%;
  height:100%;
  background:#00ff88;
}

/* Overlay */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  color:white;
  font-size:22px;
}
#overlay button{
  margin-top:20px;
  padding:12px 30px;
  font-size:18px;
  border:none;
  border-radius:6px;
  background:#00ff88;
}
</style>
</head>

<body>

<div id="ui">Level: <span id="level">1</span> | Score: <span id="score">0</span></div>
<div id="barWrap"><div id="bar"></div></div>

<div id="overlay">
  <div id="msg"></div>
  <button onclick="next()">CONTINUE</button>
</div>

<canvas id="c"></canvas>

<script>
/* ================= AUDIO + VIBRATION ================= */
let audioReady=false;
const AudioCtx = window.AudioContext || window.webkitAudioContext;
const audioCtx = new AudioCtx();

function beep(freq=400, dur=0.08){
  if(!audioReady) return;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.frequency.value=freq;
  g.gain.value=0.15;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime+dur);
}
function vibrate(p){
  if(navigator.vibrate) navigator.vibrate(p);
}

/* ================= CANVAS ================= */
const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize(); addEventListener("resize",resize);

const CX=()=>canvas.width/2;

/* ================= UI ================= */
const uiLevel=document.getElementById("level");
const uiScore=document.getElementById("score");
const bar=document.getElementById("bar");
const overlay=document.getElementById("overlay");
const msg=document.getElementById("msg");
